# JSONFormat4Flutter
å—zzz40500/GsonFormatå¯å‘ï¼Œå°†JSONObjectæ ¼å¼çš„Stringè§£ææˆdartè¯­è¨€çš„å®ä½“ç±»

## æœ¬å·¥å…·å·²è¿ç§»è‡³ç©ºå®‰å…¨(2021â€“3â€“6)
dart è¯­è¨€æ›´æ–°ä¸º null-safety è¯­æ³•åï¼Œæœ¬å·¥å…·ç”Ÿæˆçš„å®ä½“ç±»ä»£ç å°±æ— æ³•é€šè¿‡é™æ€æ£€æŸ¥ï¼Œå…·ä½“ç»†èŠ‚å¯ä»¥å‚è€ƒ[è¿ç§»Flutteré¡¹ç›®åˆ°ç©ºå®‰å…¨çš„è¡€æ³ªå²â€”â€”æœ‰è¡€ã€æœ‰æ³ªã€æœ‰ğŸ’©](http://www.debuggerx.com/2021/03/07/migrate-flutter-project-to-null-safety/)ã€‚

ä¸»è¦çš„é—®é¢˜æœ‰ï¼š
1. å®ä¾‹çš„å˜é‡éœ€è¦åœ¨å£°æ˜æ—¶åˆå§‹åŒ–ï¼Œæˆ–è€…åœ¨ç±»çš„æ„é€ æ–¹æ³•ä¸­è¿›è¡Œåˆå§‹åŒ–ï¼›
2. ç±»çš„å·¥å‚æ–¹æ³•ä¸å…è®¸è¿”å› nullï¼›
3. å¤æ‚é€»è¾‘ä¸‹çš„å¯è¾¾æ€§åˆ†æå’Œç©ºå®‰å…¨ç±»å‹æå‡å¹¶ä¸å®Œç¾(ä¾‹å¦‚å¯¹æ•°ç»„å­—æ®µç”Ÿæˆçš„èµ‹å€¼ä»£ç ï¼Œå¾ªç¯ä¸­çš„ list å¯¹è±¡é€»è¾‘ä¸Šä¸ä¼šä¸º nullï¼Œä½†æ˜¯è¯­æ³•æ£€æŸ¥å™¨è¿˜æ˜¯ä¼šå°†å…¶åˆ¤å®šä¸ºä¸å®‰å…¨çš„)

é’ˆå¯¹å¦‚ä¸Šé—®é¢˜ï¼Œæœ¬æ¬¡æ›´æ–°åšå‡ºå¦‚ä¸‹ä¿®æ”¹ï¼š
1. æ‰€æœ‰å­—æ®µçš„ç±»å‹å‡è®¾ç½®ä¸ºå¯ç©ºï¼Œäº‹å®ä¸Šç”±äºæˆ‘ä»¬æ— æ³•ä¿è¯ json å­—ç¬¦ä¸²è¾“å…¥çš„å¯é æ€§ï¼Œä¸ç®¡è®¾è®¡å¦‚ä½•ç¡®å®æ‰€æœ‰å­—æ®µéƒ½æ˜¯æœ‰å¯èƒ½ä¸ºç©ºçš„ï¼›
2. æ–°å¢ `parse(jsonStr)` é™æ€æ–¹æ³•ï¼Œç”¨äºæ›¿ä»£ä¹‹å‰çš„å·¥å‚æ„é€ å‡½æ•°ï¼Œæ¨èåœ¨é¡¹ç›®ä¸­ä¼˜å…ˆä½¿ç”¨è¯¥æ–¹æ³•è¿›è¡Œè§£æï¼›
3. å°†æ•°ç»„å­—æ®µçš„æ³›å‹ä¹Ÿå…¨éƒ¨è®¾ç½®ä¸ºå¯ç©ºçš„ï¼Œå¹¶é€šè¿‡æ·»åŠ  `!` æ ‡è¯†ç¬¦è§£å†³è¯­æ³•æ£€æŸ¥è®¤ä¸ºæ•°ç»„å­—æ®µå¯èƒ½ä¸ºç©ºä¸å¯æ“ä½œçš„é—®é¢˜ã€‚

é™¤æ­¤ä¹‹å¤–ï¼Œç”±äºå‘ç°æŸäº›ä¸‰æ–¹åº“ä¼šå°è¯•è°ƒç”¨å¯¹è±¡çš„ `toJson()` æ–¹æ³•æ¥å®ç°æ‰“å°è¾“å‡ºæˆ–åºåˆ—åŒ–ï¼Œæ‰€ä»¥æ·»åŠ  `String toJson() => this.toString();` çš„æ–¹æ³•æ˜ å°„ã€‚


## è¯¦ç»†ä»‹ç»è¯´æ˜(æ˜é‡‘)ï¼š[åœ¨Flutterå¼€å‘è¿‡ç¨‹ä¸­å¿«é€Ÿç”Ÿæˆjsonè§£ææ¨¡æ¿ç±»çš„å·¥å…·](https://juejin.im/post/5b4e04bbe51d45198c018e6e)

## ä½¿ç”¨æ¼”ç¤ºæ“ä½œï¼š

![](https://github.com/debuggerx01/JSONFormat4Flutter/blob/master/Example/json.gif?raw=true)


## ä½¿ç”¨è¯´æ˜
#### 1.ç•Œé¢æ“ä½œ (å‚è€ƒå½•å±ï¼š[parse.gif](https://github.com/debuggerx01/JSONFormat4Flutter/blob/master/Example/parse.gif))
1. å·¥å…·è¿è¡Œä»¥åï¼Œå…ˆå°†å¤åˆ¶å¥½çš„jsonå­—ç¬¦ä¸²ç²˜è´´åˆ°å·¦ä¾§æ–‡æœ¬æ¡†ï¼Œç„¶åç‚¹å‡»'æ ¼å¼åŒ–'æŒ‰é’®ï¼›å¦‚æœæç¤ºå‡ºé”™è¯·æ£€æŸ¥jsonæ˜¯å¦åˆæ³•
2. æ ¼å¼åŒ–æˆåŠŸåå·¦ä¾§jsonå°†ä¼šæŒ‰ç…§ç¼©è¿›æ ¼å¼åŒ–æ˜¾ç¤ºï¼Œå¹¶ä¸”å³ä¾§è¡¨æ ¼å°†æ˜¾ç¤ºåˆ†æå¾—å‡ºçš„jsonç»“æ„ï¼Œ'Fields'åˆ—æ˜¾ç¤ºå±‚çº§å’ŒåŸå§‹åˆ†ææ•°æ®ï¼Œ'Name'åˆ—æ˜¾ç¤ºæ¯ä¸ªå­—æ®µçš„åç§°ï¼Œ'Type'åˆ—ç”¨äºè®¾å®šå­—æ®µçš„æ•°æ®ç±»å‹
    1. å¯¹äºæ™®é€šæ•°æ®ç±»å‹(intã€ doubleã€ booleanã€ String)ï¼ŒTypesåˆ—çš„ç±»å‹å°†ä¼šè‡ªåŠ¨ç»™å‡ºï¼Œè¯·å°½é‡é¿å…åœ¨ä¸Šé¢æ»šåŠ¨é¼ æ ‡æ»šè½®å¯¼è‡´ç±»å‹é€‰æ‹©æ”¹å˜
    2. å¯¹äºå€¼nullçš„å­—æ®µï¼ŒTypesåˆ—çš„ç±»å‹ä¼šè‡ªåŠ¨è®¾ç½®ä¸ºObjectï¼Œå¹¶ä»¥é»„è‰²èƒŒæ™¯ä½œä¸ºè­¦å‘Šã€‚æ­¤æ—¶å¦‚æœç›´æ¥ç”Ÿæˆä»£ç ä¹Ÿæ˜¯å¯ä»¥ä½¿ç”¨çš„ï¼Œåªæ˜¯è¯¥å­—æ®µåœ¨ä½¿ç”¨æ—¶å¯èƒ½éœ€è¦æ‰‹åŠ¨å¼ºè½¬ï¼Œæ‰€ä»¥å»ºè®®åœ¨çŸ¥æ™“è¯¥å­—æ®µå®é™…ç±»å‹æƒ…å†µä¸‹å°½é‡è¡¥å…¨jsonå­—ç¬¦ä¸²åå†ç‚¹å‡»'æ ¼å¼åŒ–'ï¼Œæˆ–è€…åœ¨ç±»å‹ä¸‹æ‹‰æ¡†ä¸­æŒ‡å®šå®é™…çš„åŸºæœ¬æ•°æ®ç±»å‹
    3. å¯¹äºè‡ªå®šä¹‰å¯¹è±¡ç±»å‹(æˆ–è€…è¯´å­—å…¸/Map)ï¼Œ'Fields'çš„å¯¹åº”è¾“å…¥æ¡†å°†ç•™ç©ºå¹¶è®¾ä¸ºçº¢è‰²èƒŒæ™¯ï¼Œéœ€è¦æ‚¨æ‰‹åŠ¨è¾“å…¥ç±»å‹åç§°ï¼Œå¹¶è¯·æ³¨æ„ï¼š
        1. ä»»æ„ä¸€ä¸ªå­—æ®µæ²¡æœ‰è¾“å…¥ç±»å‹åæ—¶ç‚¹å‡»ä»£ç ç”ŸæˆæŒ‰é’®ï¼Œéƒ½å°†å¼¹å‡ºè­¦å‘Šæç¤ºå¹¶æ‹’ç»ç”Ÿæˆä»£ç 
        2. è®¾ç½®ç±»å‹åæ—¶å¯ä»¥å‚è€ƒåŒä¸€è¡Œ'Name'æ çš„å€¼è¿›è¡Œè®¾ç½®ä»¥æ–¹ä¾¿ä½¿ç”¨æ—¶è¯†åˆ«å­—æ®µï¼Œä¸€èˆ¬æƒ…å†µä¸‹æ¨èç›´æ¥å°†'Name'æ å†…å®¹é¦–å­—æ¯å¤§å†™ä½œä¸ºç±»å‹å
        3. ä½†æ˜¯éœ€è¦æ³¨æ„ï¼Œç±»å‹åä¸å¯ä¸'Name'æ å†…å®¹å®Œå…¨ç›¸åŒï¼Œä¸”ä¸èƒ½æ˜¯dartä¸­çš„å…³é”®å­—ï¼Œå¦åˆ™ç”Ÿæˆçš„ä»£ç å°†åŒ…å«è¯­æ³•é”™è¯¯
        4. ä¸€èˆ¬æƒ…å†µä¸‹ç¬¬ä¸€è¡Œçš„æ•°æ®ç±»å‹ä¸ºå¯¹è±¡ä¸”'Name'æ å†…å®¹ä¸ºç©ºï¼Œè®¾ç½®ç¬¬ä¸€åˆ—çš„'Types'å³ä¸ºç”Ÿæˆçš„beançš„é¡¶çº§å¯¹è±¡ç±»åï¼Œæ¨èä½¿ç”¨'è¯¥jsonçš„ä½œç”¨+Resp/Bean'å½¢å¼è¿›è¡Œå‘½åä»¥æ–¹ä¾¿ç®¡ç†
    4. å¯¹äºæ•°ç»„ç±»å‹ï¼Œ'Types'æ å°†è¢«è‡ªåŠ¨è®¾ç½®ï¼Œå¹¶ä¸”ï¼š
        1. æ•°ç»„çš„æ³›å‹ç±»å‹å–å†³äºæ•°ç»„çš„å†…å®¹çš„ç±»å‹ï¼Œä¹Ÿå°±æ˜¯ä¸‹ä¸€è¡Œè®¾ç½®çš„ç±»å‹ï¼›å½“æ•°ç»„ä¸‹ä¸€è¡Œçš„å†…å®¹ç±»å‹å˜åŒ–æ—¶æ³›å‹ä¹Ÿä¼šè‡ªåŠ¨æ”¹å˜
        2. æ”¯æŒæ•°ç»„çš„åµŒå¥—æ³›å‹ä¼ é€’
        3. æ”¯æŒç©ºæ•°ç»„ï¼Œå¹¶ä¸”ç”Ÿæˆçš„ä»£ç ä¸­å…¶æ³›å‹ä¼šè¢«è®¾ç½®ä¸ºdynamic
    5. ç‰¹æ®Šçš„ï¼Œå¦‚æœjsonæœ¬èº«çš„é¡¶å±‚çº§ä¸æ˜¯å¯¹è±¡è€Œæ˜¯æ•°ç»„ï¼Œé‚£ä¹ˆéœ€è¦ä¸ºç¬¬ä¸€è¡Œçš„'Name'æ è®¾ç½®ç±»å‹åç§°ï¼Œè·å–é¡¶å±‚çº§æ•°ç»„æ•°æ®çš„æ–¹å¼ä¸ºå¯¹è±¡bean.list
3. ç¡®è®¤è®¾ç½®æ— è¯¯åï¼Œç‚¹å‡»'ç”ŸæˆBean'æŒ‰é’®ï¼Œå·¦ä¾§jsonæ˜¾ç¤ºæ çš„å†…å®¹å°†è¢«æ›¿æ¢ä¸ºç”Ÿæˆçš„ä»£ç ï¼Œå¯ä»¥ä½¿ç”¨é¼ æ ‡é”®ç›˜å…¨é€‰å¤åˆ¶ï¼Œæˆ–è€…ç›´æ¥ç‚¹å‡»ä¸‹æ–¹çš„'å¤åˆ¶'æŒ‰é’®ï¼Œç„¶åå°†ä»£ç ç²˜è´´åˆ°IDEä¸­ï¼Œå®Œæˆè§£ææµç¨‹


#### 2.ç”Ÿæˆä»£ç è¯´æ˜  (å‚è€ƒå½•å±ï¼š[use.gif](https://github.com/debuggerx01/JSONFormat4Flutter/blob/master/Example/use.gif))

1. ååºåˆ—åŒ–(jsonå­—ç¬¦ä¸²->å¯¹è±¡)
<br>å°†ç”Ÿæˆçš„ä»£ç ç²˜è´´åˆ°dartæºæ–‡ä»¶ä¸­åï¼Œå³å¯ä»¥åœ¨ä»»æ„åœ°æ–¹å¯¼åŒ…ä½¿ç”¨ï¼Œä¸€èˆ¬æ–¹æ³•ä¸º(ä»¥http.getè¯·æ±‚ä¸ºä¾‹):
    ```java
    var response = await HTTP.get(url);
    var resp = BeanResp(response.body);
    ```
    ä¹Ÿå°±æ˜¯è¯´ï¼Œå°†è¯·æ±‚åˆ°çš„jsonå†…å®¹ä½œä¸ºå‚æ•°ä¼ é€’ç»™BeanRespçš„é»˜è®¤æ„é€ å‡½æ•°ï¼Œè¿™æ ·ç”Ÿæˆçš„respå¯¹è±¡å³æ˜¯è¯·æ±‚åˆ°å†…å®¹çš„å®ä½“ã€‚
    éœ€è¦è¯´æ˜çš„æ˜¯ï¼Œé»˜è®¤æ„é€ æ—¢å¯ä»¥ä¼ å…¥jsonçš„åŸå§‹å­—ç¬¦ä¸²ï¼Œä¹Ÿå¯ä»¥ä¼ å…¥å·²ç»ç”¨åŸç”Ÿjson.decode()æ–¹æ³•è§£æè¿‡çš„jsonå¯¹è±¡(è¿™ä¸»è¦æ˜¯ä¸ºäº†ç…§é¡¾ä½¿ç”¨dioåº“è¿›è¡Œæ•°æ®è¯·æ±‚æ—¶ç»“æœæ•°æ®ä¼šè¢«è‡ªåŠ¨è§£ææˆjsonå¯¹è±¡çš„æƒ…å†µ)ã€‚
    åªæœ‰é¡¶çº§å¯¹è±¡æ‹¥æœ‰é»˜è®¤æ„é€ æ–¹æ³•ï¼Œè€Œå…¶ä»–å­å±‚çº§å¯¹è±¡å°†ä½¿ç”¨xxx.fromJson()çš„å‘½åæ„é€ è¿›è¡Œå¯¹è±¡åˆ›å»ºã€‚

2. åºåˆ—åŒ–(å¯¹è±¡->jsonå­—ç¬¦ä¸²)
<br>ä¸å®˜æ–¹æ ·ä¾‹çš„å¤„ç†æ–¹å¼ä¸åŒï¼Œç›´æ¥è°ƒç”¨å¯¹è±¡çš„toString()æ–¹æ³•å³å¯å¾—åˆ°jsonå­—ç¬¦ä¸²å®Œæˆåºåˆ—åŒ–æ“ä½œ

3. æ‰‹åŠ¨åˆ›å»ºå¯¹è±¡
<br>ä¸ºäº†æ–¹ä¾¿å¤§éƒ¨åˆ†ä½¿ç”¨åœºæ™¯ä¸‹çš„ä¾¿åˆ©æ€§ï¼Œbeançš„é»˜è®¤æ„é€ å‡½æ•°è¢«ç”¨æ¥å®ç°ååºåˆ—åŒ–ï¼Œæ‰€ä»¥å¦‚æœæƒ³è¦åœ¨ä»£ç ä¸­æ‰‹åŠ¨ä¼ å‚åˆ›å»ºbeanå¯¹è±¡ï¼Œå¯ä»¥ä½¿ç”¨xxx.fromParams()å‘½åæ„é€ æ¥å®Œæˆã€‚

## ç®€æ˜“è¿è¡Œæ–¹å¼ï¼š
åœ¨ [Release](https://github.com/debuggerx01/JSONFormat4Flutter/releases) é¡µé¢ä¸­ï¼Œé€‰æ‹©ä¸‹è½½å¯¹åº”å¹³å°æœ€æ–°çš„äºŒè¿›åˆ¶æ–‡ä»¶åâ€”â€”
#### linux:
åœ¨ç¨‹åºç›®å½•æ‰“å¼€ç»ˆç«¯åæ‰§è¡Œï¼šchmod u+x Formatter_linux && ./Formatter_linux
#### macï¼š
åœ¨ç¨‹åºç›®å½•æ‰“å¼€ç»ˆç«¯åæ‰§è¡Œï¼šchmod u+x Formatter_mac && ./Formatter_mac
#### windowsï¼š
ç›´æ¥åŒå‡»è¿è¡Œ Formatter_win.exe
## æºç è¿è¡Œï¼ˆä»¥MACä¸ºä¾‹ï¼‰
æ²¡æœ‰pythonè¿è¡Œç¯å¢ƒçš„ç”¨æˆ·éœ€è¦å…ˆå®‰è£…python

macä¸­å¯ä»¥ä½¿ç”¨å¦‚ä¸‹å‘½ä»¤å®‰è£…
```
brew install python3
brew install pip3
```
pip3æ˜¯python3çš„åŒ…ç®¡ç†å·¥å…·

brew å¯ä»¥å‚è€ƒä¸‹é¢çš„é“¾æ¥

https://brew.sh/index_zh-cn



è¿è¡Œåº“çš„æ—¶å€™ä¼šå¯èƒ½ä¼šæç¤º
```
Traceback (most recent call last):
  File "formater.py", line 8, in <module>
    from mainwindow import *
  File "/Users/cjl/IdeaProjects/flutter/sxw-flutter-app/JSONFormat4Flutter/mainwindow.py", line 9, in <module>
    from PyQt5 import QtCore, QtGui, QtWidgets
ModuleNotFoundError: No module named 'PyQt5'

```

è¿™æ—¶å€™å¯ä»¥ç›´æ¥ç”¨
`pip3 install PyQt5`
`pip3 install pyperclip`
ç­‰å¾…å®‰è£…å®Œæˆ

``ï¼ˆæ³¨ï¼šbrewå®‰è£…æœ€æ–°ç‰ˆpython3å¯èƒ½ä¼šå‡ºç°sslæ¨¡å—ä¸¢å¤±å¯¼è‡´pip3æ— æ³•æ­£å¸¸ä½¿ç”¨ï¼Œæ­¤æ—¶ä¹Ÿå¯ä»¥è€ƒè™‘ç›´æ¥åœ¨pythonå®˜ç½‘ä¸‹è½½pkgåŒ…æ–¹å¼å®‰è£…pythonï¼‰``

åé¢ä½¿ç”¨å°±æ˜¯åœ¨å‘½ä»¤è¡Œæ•²å…¥
`python3 formatter.py`

## å·²çŸ¥é—®é¢˜
+ macä¸‹ä»æ–‡æœ¬æ¡†å¤åˆ¶å‡ºçš„æ–‡å­—ç›´æ¥ç²˜è´´åˆ° idea/android studio ä¸­æŠ¥é”™ " lllegal character '65279' "

å‚è€ƒ [issue1](https://github.com/debuggerx01/JSONFormat4Flutter/issues/1) ï¼Œå¦‚ä¸‹å›¾ï¼Œä½¿ç”¨5.7.1åŠä¹‹å‰ç‰ˆæœ¬çš„pyqt5

![](https://user-gold-cdn.xitu.io/2018/7/17/164a8c24460f41ee?w=1270&h=861&f=png&s=174844)

## build
- Linux:
```shell
nuitka3 --clang --standalone --windows-disable-console --linux-onefile-icon=logo.png --output-dir=output --show-progress --plugin-enable=qt-plugins --onefile formatter.py
```
- Windows:
```shell
pyinstaller -F -w -i logo.ico formatter.py
```